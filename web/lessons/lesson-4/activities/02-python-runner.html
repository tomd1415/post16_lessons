<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>a02 - Python runner (MVP)</title>
  <link rel="stylesheet" href="../../../core/app.css" />
</head>
<body data-lesson-id="lesson-4" data-activity-id="a02" data-requires-role="pupil">
  <div class="topbar no-print">
    <div class="container">
      <div class="brand">
        <b>a02 - Python runner (MVP)</b>
        <span>Safe, server-side Python execution</span>
      </div>
      <div class="row">
        <a class="pill" href="../index.html"><strong>HOME</strong> <span>Teacher hub</span></a>
        <a class="pill" href="../student.html"><strong>STUDENT</strong> <span>Student hub</span></a>
        <span id="userBadge" class="badge" style="display:none"></span>
        <button class="btn" id="logoutBtn" type="button">Logout</button>
        <button class="btn" id="teacherToggle" type="button">Teacher mode: OFF</button>
      </div>
    </div>
  </div>

  <div class="container">
    <h1>a02 - Python runner (MVP)</h1>
    <div class="note">
      <b>How this works:</b> Write code, run it on the server, and review the output. The runner is isolated (no network) with strict time and memory limits.
    </div>

    <div class="grid cols2" style="margin-top:12px">
      <div class="card">
        <h2>Step 1: Quick checks</h2>
        <p><b>Prompt 1:</b> Which function prints output to the screen?</p>
        <div data-quiz="q1" data-correct="a">
          <label class="choice"><input type="radio" name="q1" value="a"> print()</label>
          <label class="choice"><input type="radio" name="q1" value="b"> input()</label>
          <label class="choice"><input type="radio" name="q1" value="c"> save()</label>
        </div>
        <div class="row" style="margin-top:8px">
          <button class="btn good" data-quiz-check="q1" type="button">Check</button>
        </div>
        <div class="note" data-quiz-feedback="q1" style="margin-top:10px; display:none"></div>

        <div style="height:10px"></div>
        <p><b>Prompt 2:</b> Which symbol starts a comment in Python?</p>
        <div data-quiz="q2" data-correct="b">
          <label class="choice"><input type="radio" name="q2" value="a"> //</label>
          <label class="choice"><input type="radio" name="q2" value="b"> #</label>
          <label class="choice"><input type="radio" name="q2" value="c"> --</label>
        </div>
        <div class="row" style="margin-top:8px">
          <button class="btn good" data-quiz-check="q2" type="button">Check</button>
        </div>
        <div class="note" data-quiz-feedback="q2" style="margin-top:10px; display:none"></div>

        <div style="height:10px"></div>
        <p><b>Prompt 3:</b> Which function asks the user for input?</p>
        <div data-quiz="q3" data-correct="c">
          <label class="choice"><input type="radio" name="q3" value="a"> open()</label>
          <label class="choice"><input type="radio" name="q3" value="b"> output()</label>
          <label class="choice"><input type="radio" name="q3" value="c"> input()</label>
        </div>
        <div class="row" style="margin-top:8px">
          <button class="btn good" data-quiz-check="q3" type="button">Check</button>
        </div>
        <div class="note" data-quiz-feedback="q3" style="margin-top:10px; display:none"></div>
      </div>

      <div class="card">
        <h2>Step 2: Code editor</h2>
        <p>Start with the example, then make changes and run.</p>
        <textarea id="codeEditor" class="code-editor" spellcheck="false"></textarea>
        <template data-hint-code-template="code-step-1">
          # Starter: run a simple program
          name = "Coder"
          print("Hello", name)
          
          # TODO: add another print line
          # TODO: write a note to a file
          with open("notes.txt", "w") as f:
              f.write("My first note")
        </template>
        <div class="row" style="margin-top:10px">
          <button class="btn good" id="runBtn" type="button">Run code</button>
          <button class="btn" id="saveFilesBtn" type="button">Save files</button>
          <button class="btn bad" id="resetBtn" type="button">Reset</button>
        </div>
        <div class="note" style="margin-top:10px">
          <b>Limits:</b> No internet access, 3 seconds max runtime, 128MB memory.
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <h2>Step 3: Plan your run</h2>
      <p>Fill the boxes before you click <b>Run code</b>.</p>
      <table class="table">
        <thead><tr><th>Prompt</th><th>Your answer</th></tr></thead>
        <tbody>
          <tr><td>Test input (if any)</td><td><input type="text" data-field="plan_input" placeholder="e.g., name or number" /></td></tr>
          <tr><td>Expected output</td><td><input type="text" data-field="plan_output" placeholder="e.g., Hello Sam" /></td></tr>
          <tr><td>Change you will test</td><td><input type="text" data-field="plan_change" placeholder="e.g., add second print line" /></td></tr>
        </tbody>
      </table>

      <h3>Run log</h3>
      <table class="table">
        <thead><tr><th>Run #</th><th>What changed</th><th>Output OK?</th><th>Error note</th></tr></thead>
        <tbody>
          <tr><td>1</td><td><input type="text" data-field="run1_change" /></td><td><input type="checkbox" aria-label="Run1 ok"></td><td><input type="text" data-field="run1_err" /></td></tr>
          <tr><td>2</td><td><input type="text" data-field="run2_change" /></td><td><input type="checkbox" aria-label="Run2 ok"></td><td><input type="text" data-field="run2_err" /></td></tr>
        </tbody>
      </table>
    </div>

    <div class="grid cols2" style="margin-top:12px">
      <div class="card">
        <h2>Step 4: Run output</h2>
        <div class="note">
          Outputs are saved with your attempt so teachers can review them later.
        </div>
        <label for="stdout"><b>Stdout</b></label>
        <pre id="stdout" class="code-output"></pre>
        <label for="stderr"><b>Stderr</b></label>
        <pre id="stderr" class="code-output warn"></pre>
        <div id="runMeta" class="note" style="margin-top:10px; display:none"></div>
      </div>

      <div class="card">
        <h2>Step 5: Files</h2>
        <div class="note">
          Files created during a run are shown below. Use <b>Save files</b> to keep them with your attempt.
        </div>
        <div id="runFiles" class="file-list"></div>
        <div style="height:10px"></div>
        <h3>Saved files</h3>
        <div id="savedFiles" class="file-list"></div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <h2>Step 6: Reflection</h2>
      <p>What did you change? What worked first time? What will you try next?</p>
      <textarea data-field="reflection" placeholder="My reflections..."></textarea>
    </div>

    <div class="card debug-quick-match" style="margin-top:12px">
      <h2>Debugging quick match</h2>
      <div class="note warn">Runner tip: this runner does not accept live <code>input()</code>. For testing, replace <code>input()</code> with a fixed value, then switch back.</div>

      <p><b>Prompt 1:</b> NameError: name 'score' is not defined</p>
      <div data-quiz="dbg1" data-correct="b">
        <label class="choice"><input type="radio" name="dbg1" value="a"> Add quotes around score</label>
        <label class="choice"><input type="radio" name="dbg1" value="b"> Define score before using it</label>
        <label class="choice"><input type="radio" name="dbg1" value="c"> Replace = with ==</label>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn good" data-quiz-check="dbg1" type="button">Check</button>
      </div>
      <div class="note" data-quiz-feedback="dbg1" style="margin-top:10px; display:none"></div>

      <div style="height:10px"></div>
      <p><b>Prompt 2:</b> SyntaxError: invalid syntax (line ends with <code>if score &gt; 10</code>)</p>
      <div data-quiz="dbg2" data-correct="c">
        <label class="choice"><input type="radio" name="dbg2" value="a"> Add print() around the line</label>
        <label class="choice"><input type="radio" name="dbg2" value="b"> Remove indentation</label>
        <label class="choice"><input type="radio" name="dbg2" value="c"> Add a colon at the end of the line</label>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn good" data-quiz-check="dbg2" type="button">Check</button>
      </div>
      <div class="note" data-quiz-feedback="dbg2" style="margin-top:10px; display:none"></div>

      <div style="height:10px"></div>
      <p><b>Prompt 3:</b> TypeError: can only concatenate str (not "int") to str</p>
      <div data-quiz="dbg3" data-correct="a">
        <label class="choice"><input type="radio" name="dbg3" value="a"> Convert the int to a string (str(...) or f-string)</label>
        <label class="choice"><input type="radio" name="dbg3" value="b"> Replace + with -</label>
        <label class="choice"><input type="radio" name="dbg3" value="c"> Delete the integer value</label>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn good" data-quiz-check="dbg3" type="button">Check</button>
      </div>
      <div class="note" data-quiz-feedback="dbg3" style="margin-top:10px; display:none"></div>
    </div>

    <div class="teacher-only card" style="margin-top:12px; display:none">
      <h2>Teacher guidance (answer prompts)</h2>
      <ul class="list">
        <li>Quick check answers: print(), #, input().</li>
        <li>Encourage pupils to save outputs after each successful run.</li>
        <li>Turtle: import turtle draws an SVG file named turtle.svg for review.</li>
      </ul>
    </div>

    <div class="footer">
      <div id="toast" class="toast" role="status" aria-live="polite"></div>
      <div class="no-print">
        <hr class="sep"/>
        <small>
          Tip: add <span class="kbd">?teacher=1</span> to the URL to force teacher mode on.
        </small>
      </div>
    </div>
  </div>

  <script src="../../../core/error-handler.js"></script>
  <script src="../../../core/app.js"></script>
  <script src="../../../core/auth.js"></script>
  <script src="../../../core/python-runner.js"></script>
</body>
</html>
